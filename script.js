ace.config.set("basePath","https://cdn.jsdelivr.net/npm/ace-builds@1.36.2/src-min-noconflict");const htmlEditor=ace.edit("editor-html",{theme:"ace/theme/one_dark",mode:"ace/mode/html",fontSize:14,showPrintMargin:!1,wrap:!0,useWorker:!0,enableBasicAutocompletion:!0,enableLiveAutocompletion:!0}),cssEditor=ace.edit("editor-css",{theme:"ace/theme/one_dark",mode:"ace/mode/css",fontSize:14,showPrintMargin:!1,wrap:!0,useWorker:!0,enableBasicAutocompletion:!0,enableLiveAutocompletion:!0}),jsEditor=ace.edit("editor-js",{theme:"ace/theme/one_dark",mode:"ace/mode/javascript",fontSize:14,showPrintMargin:!1,wrap:!0,useWorker:!0,enableBasicAutocompletion:!0,enableLiveAutocompletion:!0}),starterHTML=`<!doctype html><html><head><meta name="viewport" content="width=device-width, initial-scale=1"/><title>My Android HTML App</title><style>body{margin:0;font-family:system-ui,Roboto,Arial;background:#0f172a;color:#e5e7eb}header{position:sticky;top:0;background:#111827;padding:14px 16px;font-weight:700;letter-spacing:.3px}main{padding:18px}.card{background:#0b1220;border:1px solid #1f2937;border-radius:16px;padding:16px;margin:12px 0;box-shadow:0 8px 24px rgba(0,0,0,.25)}button{padding:10px 14px;border-radius:12px;border:1px solid #1f2937;background:#1d4ed8;color:white}</style></head><body><header>ðŸ“± My Android HTML App</header><main><p>Live edit this app with HTML/CSS/JS. The phone on the right updates instantly.</p><div class="card"><h3>Hello, Jonah! ðŸ‘‹</h3><p>This is your 6.9" preview simulator.</p><button onclick="alert('It\\'s working!')">Tap Me</button></div></main></body></html>`;htmlEditor.setValue(starterHTML,-1),cssEditor.setValue("",-1),jsEditor.setValue("",-1);const LS={html:"ppe_html",css:"ppe_css",js:"ppe_js",tab:"ppe_tab",scaleW:"ppe_scaleW",scaleH:"ppe_scaleH",radius:"ppe_radius",rotated:"ppe_rotated",device:"ppe_device",theme:"ppe_theme",sw_ms:"ppe_sw_ms",sw_run:"ppe_sw_run",sw_start:"ppe_sw_start",split:"ppe_split",swap:"ppe_swap"};function safeGet(e){try{return localStorage.getItem(e)}catch{return null}}function safeSet(e,t){try{localStorage.setItem(e,t)}catch{}}const savedHTML=safeGet(LS.html);null!==savedHTML&&htmlEditor.setValue(savedHTML,-1);const savedCSS=safeGet(LS.css);null!==savedCSS&&cssEditor.setValue(savedCSS,-1);const savedJS=safeGet(LS.js);null!==savedJS&&jsEditor.setValue(savedJS,-1),document.querySelectorAll(".tab").forEach(e=>{e.onclick=()=>{document.querySelectorAll(".tab").forEach(e=>e.classList.remove("active")),e.classList.add("active"),["html","css","js"].forEach(t=>{let s=document.getElementById(`editor-${t}`);s.classList.toggle("active",t===e.dataset.target)}),setTimeout(()=>{htmlEditor.resize(),cssEditor.resize(),jsEditor.resize()},0),safeSet(LS.tab,e.dataset.target),renderProblems(e.dataset.target)}});const tabsByLang={html:document.querySelector('.tabs .tab[data-target="html"]'),css:document.querySelector('.tabs .tab[data-target="css"]'),js:document.querySelector('.tabs .tab[data-target="js"]')},editorsByLang={html:htmlEditor,css:cssEditor,js:jsEditor},badges={};function updateBadge(e){let t=editorsByLang[e];if(!t)return;let s=t.session.getAnnotations()||[],a=s.filter(e=>"error"===e.type),n=a.length,l=tabsByLang[e],i=badges[e];l&&i&&(i.textContent=String(n),l.classList.toggle("error",n>0),l.title=n>0?`${n} error${n>1?"s":""} in ${e.toUpperCase()}`:"")}function onAnnChange(e){updateBadge(e);let t=document.querySelector(".tabs .tab.active");t&&t.dataset.target===e&&renderProblems(e),updateProblemsCount(e)}Object.keys(tabsByLang).forEach(e=>{let t=document.createElement("span");t.className="badge",t.textContent="0",tabsByLang[e]?.appendChild(t),badges[e]=t}),htmlEditor.session.on("changeAnnotation",()=>onAnnChange("html")),cssEditor.session.on("changeAnnotation",()=>onAnnChange("css")),jsEditor.session.on("changeAnnotation",()=>onAnnChange("js")),setTimeout(()=>{["html","css","js"].forEach(e=>{updateBadge(e)}),renderProblems(activeLang())},0);const problemsBtn=document.getElementById("problems"),problemsPanel=document.getElementById("problemsPanel"),problemsCountEl=document.getElementById("problemsCount");function editorFor(e){return"css"===e?cssEditor:"js"===e?jsEditor:htmlEditor}function collectProblems(e){let t=editorFor(e);if(!t)return[];let s=t.session.getAnnotations()||[];return s.map(e=>({type:e.type||"info",text:String(e.text||""),row:Number.isInteger(e.row)?e.row:0,column:Number.isInteger(e.column)?e.column:0}))}function updateProblemsCount(e){let t=collectProblems(e).filter(e=>"error"===e.type),s=t.length;problemsCountEl&&(problemsCountEl.textContent=String(s),problemsCountEl.style.display=s>0?"inline-block":"none")}function iconFor(e){return"warning"===e?"ti-alert-circle":"error"===e?"ti-alert-triangle":"ti-info-circle"}function colorFor(e){return"warning"===e?"#f59e0b":"error"===e?"#ef4444":"#60a5fa"}function renderProblems(e){if(!problemsPanel)return;let t=collectProblems(e);if(updateProblemsCount(e),0===t.length){problemsPanel.innerHTML='<div class="item" style="opacity:.7"><span class="ic"><i class="ti ti-circle-check" style="color:#34d399"></i></span><div class="msg">No problems</div></div>';return}problemsPanel.innerHTML=t.map((t,s)=>{let a=t.row+1,n=t.column+1;return`<div class="item" data-idx="${s}" data-row="${t.row}" data-col="${t.column}" data-type="${t.type}">
          <span class="ic"><i class="ti ${iconFor(t.type)}" style="color:${colorFor(t.type)}"></i></span>
          <div class="msg">${t.text||"(unknown)"}<div class="loc">${e.toUpperCase()} â€¢ ${a}:${n}</div></div>
        </div>`}).join("")}problemsBtn?.addEventListener("click",()=>{let e=activeLang();renderProblems(e);let t="none"!==problemsPanel.style.display;problemsPanel.style.display=t?"none":"block"}),problemsPanel?.addEventListener("click",e=>{let t=e.target.closest(".item");if(!t)return;let s=activeLang(),a=parseInt(t.dataset.row||"0",10)||0,n=parseInt(t.dataset.col||"0",10)||0,l=editorFor(s);l&&(l.focus(),l.gotoLine(a+1,n,!0),l.centerSelection())});const savedTab=safeGet(LS.tab)||"html",tabBtn=document.querySelector(`.tabs .tab[data-target="${savedTab}"]`);tabBtn&&tabBtn.click();const iframe=document.getElementById("preview"),auto=document.getElementById("auto"),build=()=>{let e=htmlEditor.getValue(),t=cssEditor.getValue(),s=jsEditor.getValue(),a=/<head[\s>]/i.test(e),n;n=a?e.replace(/<\/head>/i,"<style>"+t+"</style></head>"):'<!doctype html><html><head><meta name="viewport" content="width=device-width, initial-scale=1"/><style>'+t+"</style></head><body>"+e+"</body></html>";let l="<style>html,body{overflow-x:hidden!important;overflow-y:auto!important}</style>",i="<style>::selection{background:rgba(66,133,244,.35)}::-moz-selection{background:rgba(66,133,244,.35)}</style>";n=(n=/<head[\s>]/i.test(n)?n.replace(/<\/head>/i,l+i+"</head>"):n.replace(/<body[^>]*>/i,"$&"+l+i)).replace(/<\/body>/i,"<script>"+s+"</script></body>"),iframe.srcdoc=n};function combinedHTML(){let e=htmlEditor.getValue(),t=cssEditor.getValue(),s=jsEditor.getValue(),a=/<head[\s>]/i.test(e);e=a?e.replace(/<\/head>/i,"<style>"+t+"</style></head>"):'<!doctype html><html><head><meta name="viewport" content="width=device-width, initial-scale=1"/><style>'+t+"</style></head><body>"+e+"</body></html>";let n="<style>html,body{overflow-x:hidden!important;overflow-y:auto!important}</style>";return(e=/<head[\s>]/i.test(e)?e.replace(/<\/head>/i,n+"</head>"):e.replace(/<body[^>]*>/i,"$&"+n)).replace(/<\/body>/i,"<script>"+s+"</script></body>")}htmlEditor.on("change",()=>{safeSet(LS.html,htmlEditor.getValue()),auto.checked&&setTimeout(build,200)}),cssEditor.on("change",()=>{safeSet(LS.css,cssEditor.getValue()),auto.checked&&setTimeout(build,200)}),jsEditor.on("change",()=>{safeSet(LS.js,jsEditor.getValue()),auto.checked&&setTimeout(build,200)});const copyBtn=document.getElementById("copy");function activeLang(){let e=document.querySelector(".tabs .tab.active");return e?e.dataset.target:"html"}copyBtn.addEventListener("click",async()=>{try{let e=activeLang(),t="";"html"===e?t=htmlEditor.getValue():"css"===e?t=cssEditor.getValue():"js"===e&&(t=jsEditor.getValue()),await navigator.clipboard.writeText(t);let s=copyBtn.innerHTML,a="html"===e?"HTML":"css"===e?"CSS":"JS";copyBtn.innerHTML=`<i class="ti ti-check"></i> Copied ${a}!`,setTimeout(()=>copyBtn.innerHTML=s,1200)}catch(n){let l=copyBtn.innerHTML;copyBtn.innerHTML='<i class="ti ti-alert-triangle"></i> Failed',setTimeout(()=>copyBtn.innerHTML=l,1200),console.error(n)}}),build();const swTimeEl=document.getElementById("swTime"),swToggle=document.getElementById("swToggle"),swReset=document.getElementById("swReset");let swMs=parseInt(safeGet(LS.sw_ms)||"0",10)||0,swRunning="1"===safeGet(LS.sw_run),swStart=parseInt(safeGet(LS.sw_start)||"0",10)||0,swTimer=null;function swFormat(e){let t=Math.floor(e/1e3),s=Math.floor(t/60),a=t%60,n=s<10?"0"+s:String(s),l=a<10?"0"+a:String(a);return n+":"+l}function swRender(){swTimeEl.textContent=swFormat(swMs+(swRunning?Date.now()-swStart:0))}function swTick(){swRender()}function swStartTimer(){swTimer||(swStart=Date.now(),safeSet(LS.sw_start,String(swStart)),swRunning=!0,safeSet(LS.sw_run,"1"),swToggle.querySelector("i").className="ti ti-player-pause",swTimer=setInterval(swTick,250),swRender())}function swPause(){swRunning&&(swMs+=Date.now()-swStart,safeSet(LS.sw_ms,String(swMs)),swRunning=!1,safeSet(LS.sw_run,"0"),swToggle.querySelector("i").className="ti ti-player-play",swTimer&&(clearInterval(swTimer),swTimer=null),swRender())}function swResetAll(){swMs=0,safeSet(LS.sw_ms,"0"),swStart=Date.now(),safeSet(LS.sw_start,String(swStart)),swRunning||(swToggle.querySelector("i").className="ti ti-player-play"),swRender()}swToggle?.addEventListener("click",()=>{swRunning?swPause():swStartTimer()}),swReset?.addEventListener("click",()=>{swResetAll()}),swRunning&&(swToggle.querySelector("i").className="ti ti-player-pause",swTimer=setInterval(swTick,250)),swRender();const themeBtn=document.getElementById("themeToggle");function aceApplyTheme(e){let t="light"===e?"ace/theme/chrome":"ace/theme/one_dark";htmlEditor.setTheme(t),cssEditor.setTheme(t),jsEditor.setTheme(t)}function updateThemeIcon(e){if(!themeBtn)return;let t=themeBtn.querySelector("i");t&&(t.className="ti "+("light"===e?"ti-sun":"ti-moon"),themeBtn.title="light"===e?"Light mode":"Dark mode")}function applyTheme(e){let t=document.documentElement;"light"===e?t.setAttribute("data-theme","light"):t.removeAttribute("data-theme"),aceApplyTheme("light"===e?"light":"dark"),updateThemeIcon("light"===e?"light":"dark"),safeSet(LS.theme,"light"===e?"light":"dark")}!function e(){let t=safeGet(LS.theme),s=t;if(!s){let a=window.matchMedia&&window.matchMedia("(prefers-color-scheme: light)").matches;s=a?"light":"dark"}applyTheme(s)}(),themeBtn&&themeBtn.addEventListener("click",()=>{let e="light"===document.documentElement.getAttribute("data-theme");applyTheme(e?"dark":"light")});const appEl=document.querySelector(".app"),leftEl=document.getElementById("left"),rightEl=document.getElementById("right"),splitter=document.getElementById("splitter"),DIVIDER_W=8,GAP_W=12,MIN_LEFT=420,MIN_RIGHT=420;function applySplit(e){let t=appEl.clientWidth-24,s=Math.min(Math.max(e,420),Math.max(420,t-8-420));return appEl.classList.contains("swap")?appEl.style.gridTemplateColumns=`1fr 8px ${s}px`:appEl.style.gridTemplateColumns=`${s}px 8px 1fr`,s}const savedSplit=safeGet(LS.split);if(savedSplit){let e=parseFloat(savedSplit);Number.isNaN(e)||applySplit(e)}const swapBtn=document.getElementById("swapPanels"),savedSwap="1"===safeGet(LS.swap);if(savedSwap&&appEl.classList.add("swap"),savedSwap&&savedSplit){let t=parseFloat(savedSplit);Number.isNaN(t)||applySplit(t)}swapBtn&&swapBtn.addEventListener("click",()=>{let e=leftWidthPx();appEl.classList.toggle("swap");let t=applySplit(e);safeSet(LS.split,String(t)),safeSet(LS.swap,appEl.classList.contains("swap")?"1":"0")});let dragging=!1,startX=0,startLeft=0;function leftWidthPx(){let e=leftEl.getBoundingClientRect();return e.width}function onMouseMove(e){if(!dragging)return;let t=e.clientX-startX,s=applySplit(startLeft+t);safeSet(LS.split,String(s))}function onMouseUp(){dragging&&(dragging=!1,appEl.classList.remove("dragging"),window.removeEventListener("mousemove",onMouseMove),window.removeEventListener("mouseup",onMouseUp))}splitter.addEventListener("mousedown",e=>{dragging=!0,startX=e.clientX,startLeft=leftWidthPx(),appEl.classList.add("dragging"),window.addEventListener("mousemove",onMouseMove),window.addEventListener("mouseup",onMouseUp),e.preventDefault()}),splitter.addEventListener("dblclick",()=>{appEl.style.gridTemplateColumns="",safeSet(LS.split,"")}),window.addEventListener("resize",()=>{let e=parseFloat(safeGet(LS.split)||"");Number.isNaN(e)||applySplit(e)});const phoneEl=document.getElementById("phone"),scaleW=document.getElementById("scaleW"),scaleH=document.getElementById("scaleH");let currentRadius=38;const rotateBtn=document.getElementById("rotate");let currentDevice="phone",rotated=!1;const sw=safeGet(LS.scaleW);null!==sw&&(scaleW.value=sw);const sh=safeGet(LS.scaleH);null!==sh&&(scaleH.value=sh);const rr=safeGet(LS.radius);null!==rr&&(currentRadius=parseFloat(rr));const rotS=safeGet(LS.rotated);null!==rotS&&(rotated="1"===rotS);const savedDev=safeGet(LS.device)||"phone";currentDevice=savedDev;const innerScreen=phoneEl.querySelector(".screen");function applyTransform(){let e=parseFloat(scaleW.value),t=parseFloat(scaleH.value),s=rotated?"rotate(90deg) ":"";phoneEl.style.transform=s+`scale(${e}, ${t})`,innerScreen.style.transformOrigin="top left",innerScreen.style.width=100*e+"%",innerScreen.style.height=100*t+"%",innerScreen.style.transform=`scale(${1/e}, ${1/t})`}function applyRadius(){let e=Number.isFinite(currentRadius)?currentRadius:38;phoneEl.style.borderRadius=e+"px",innerScreen.style.borderRadius=Math.max(0,e-12)+"px"}scaleW.addEventListener("input",()=>{safeSet(LS.scaleW,scaleW.value),applyTransform()}),scaleH.addEventListener("input",()=>{safeSet(LS.scaleH,scaleH.value),applyTransform()}),rotateBtn.addEventListener("click",()=>{rotated=!rotated,safeSet(LS.rotated,rotated?"1":"0"),applyTransform()}),applyTransform(),applyRadius();const settingsBtn=document.getElementById("settings"),modal=document.getElementById("settingsModal"),dlgClose=document.getElementById("dlgClose"),dlgCancel=document.getElementById("dlgCancel"),dlgSave=document.getElementById("dlgSave"),dlgRadius=document.getElementById("dlgRadius"),dlgRadiusNum=document.getElementById("dlgRadiusNum"),dlgDevice=document.getElementById("dlgDevice");let prevRadius=String(Number.isFinite(currentRadius)?currentRadius:38),prevDevice=currentDevice;function openSettings(){prevRadius=String(Number.isFinite(currentRadius)?currentRadius:38),prevDevice=currentDevice,dlgRadius.value=prevRadius,dlgRadiusNum.value=prevRadius,dlgDevice.value=currentDevice,modal.classList.add("open"),setTimeout(()=>dlgRadius.focus(),0)}function closeSettings(){modal.classList.remove("open")}function syncRadius(e){let t=Math.max(0,Math.min(80,Number(e)||0));dlgRadius.value=String(t),dlgRadiusNum.value=String(t),currentRadius=t,applyRadius()}function syncDevice(e){applyDevice(currentDevice="tablet"===e?"tablet":"phone")}function applyDevice(e){phoneEl.classList.remove("device-phone","device-tablet"),phoneEl.classList.add("tablet"===e?"device-tablet":"device-phone"),currentRadius="tablet"===e?20:38,applyRadius()}dlgRadius.addEventListener("input",()=>syncRadius(dlgRadius.value)),dlgRadiusNum.addEventListener("input",()=>syncRadius(dlgRadiusNum.value)),dlgDevice.addEventListener("change",()=>syncDevice(dlgDevice.value)),settingsBtn&&settingsBtn.addEventListener("click",openSettings),dlgClose.addEventListener("click",closeSettings),dlgCancel.addEventListener("click",()=>{currentRadius=parseFloat(prevRadius),applyRadius(),applyDevice(currentDevice=prevDevice),closeSettings()}),dlgSave.addEventListener("click",()=>{safeSet(LS.radius,String(currentRadius)),safeSet(LS.device,currentDevice),closeSettings()}),modal.addEventListener("click",e=>{e.target===modal&&closeSettings()}),window.addEventListener("keydown",e=>{"Escape"===e.key&&modal.classList.contains("open")&&closeSettings()});const legacyRadiusEl=document.getElementById("radius");if(legacyRadiusEl){let s=legacyRadiusEl.previousElementSibling;s&&"LABEL"===s.tagName&&s.remove(),legacyRadiusEl.remove()}const legacyDeviceSel=document.getElementById("device");legacyDeviceSel&&legacyDeviceSel.remove(),applyDevice(currentDevice),document.getElementById("download").onclick=async()=>{let e=new JSZip,t=htmlEditor.getValue(),s=cssEditor.getValue(),a=jsEditor.getValue(),n=/<head[\s>]/i.test(t),l="</script>",i="<style>html,body{overflow-x:hidden!important;overflow-y:auto!important}</style>";t=n?t.replace(/<\/head>/i,"<style>"+s+"</style>"+i+"</head>").replace(/<\/body>/i,"<script>"+a+l+"</body>"):'<!doctype html><html><head><meta name="viewport" content="width=device-width, initial-scale=1"/><style>'+s+"</style>"+i+"</head><body>"+t+"<script>"+a+l+"</body></html>",e.file("index.html",t),saveAs(await e.generateAsync({type:"blob"}),"android-html-app.zip")};